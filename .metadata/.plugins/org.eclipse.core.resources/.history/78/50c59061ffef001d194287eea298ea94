<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
    
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>
<c:set var="path" value="${pageContext.request.contextPath}"></c:set>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>특정 옵션 선택</title>
</head>
<style>
	#selector-search-header{
		padding:1rem;
		border:1px solid gray;
		display:flex;
		align-items: center;
	}
	.selector-search-left{
		width:70%;
	}
	.selector-search-right{
		width:30%;
		display:flex;
		justify-content: flex-end;
	}
</style>
<body>
	<div id="change-List-contents">
		<div id="selector-search-header">
			<div class="selector-search-left">
				<label id="selector-name"></label>
				<select name="" id="optionSelect">
					<option>선택하세요</option>
			    	<c:forEach items="${selectorlist}" var="item">
			    		<option>${item}</option>
			    	</c:forEach>
			    </select>
			</div>
		    <div class="selector-search-right">
		    	<button class="search-btn btn btn-primary">검색</button>
		    </div>
		</div>
	    <div id="selector-search-content"></div>
	</div>
</body>
<script>
$(function(){
	const PATH = getContextPath();
	const apiPath = {
			'model' : "searchEquipmentByModel.do",
			'type_name': "searchEquipmentByType.do"
  	};
	
	$(".search-btn").click(function() {
		const select = $("#optionSelect").val();
		const btnType = $(this).attr("data-btnType");
		const addBtnClass = btnType === '대여' ? "btn-primary" : "btn-danger";
		const key = $("#optionSelect").attr("name");
		const makeData = {}
		makeData[key] = select;
		
		 $.ajax({
			url: PATH + "/equi/" + apiPath[key],
			method:"post",
			data: makeData,
			success:(res)=>{
				$("#selector-search-content").html(res);
				$(".rentalType-btn").html(btnType).addClass(addBtnClass).attr("data-btnType",btnType);
			},
			error:(err)=>{
				console.log(err);
			}
		}); 
	});
	
	$(".rentalType-btn").click(function() {
		const btnType = $(this).attr("data-btnType");
	});
});
</script>
</html>